<?xml version="1.0" encoding="utf-8" ?>
<!--    
        [Columns]
          COLUMN_Path = "_Path_";
          COLUMN_LastModified = "_LastModified_";
          COLUMN_Size = "_Size_";
          COLUMN_Attributes = "_Attributes_";
          COLUMN_FileCount = "_FileCount_";
          COLUMN_SubFolderCount = "_SubFolderCount_";
          COLUMN_FromFile = "_FromFile_";
          COLUMN_FilesType = "_FilesType_";
        [Formatters]
          rule = "_static.appended_"
          rule = "_static.deleted_"
          rule = "_static.updated_"
        
        [Document templatePath="{path}" baselinePath="{path}" backup="{true/false}" outputPath="{path}"] - The root node for configuration, only has one.
          templatePath = "c:\template.xlsx" - templated doc used to generate. [optional default=""]
          baselinePath = "c:\mjm.xlsx" - todo... forget [optional default=""]
          backup = "true" - identify backup the old doc or not. [optional default="true"]
          outputPath = "c:\mjm.xlsx" - the output path for this generation. [optional default="{DateTime.Now.ToString("yyyyMMdd")}"]
          
        [Sheets] - The container for all sheets, only has one.
        
        [Sheet name="{string}" enabled="{true/false}" mode="{refresh/append}" maxRowCount="{int}" refMode="{true/false}"]
          name = "高清电影" [required]
          enabled = "true" [optional default="true"]
          mode = "refresh" [optional default="refresh"]
          maxRowCount = "600" [optional default="3000"]
          refMode = "false" [optional default="true"] - todo, forget...
          
        [Formatters]
        
        [Formatter name="{string}" enabled="{true/false}" extractFrom="{string.Empty}" ruleType="{string:ruleType*}" rule="{string:rule*}" formatString="{string:formatString*}"]
          name = "append_formatter" [required] - not used actually, just a name.
          enabled = "true" [optional default="true"]
          extractFrom = "中文名" [required] - From every column defined, allow string.Empty
          ruleType = "AppendedItemFormatter" [required] - *AppendedItemFormatter
                                                          *DateTimeCompareFormatter
                                                          *DeletedItemFormatter
                                                          *DuplicatedItemFormatter
                                                          *NumberCompareFormatter
                                                          *RefreshedItemFormatter
                                                          *UpdatedItemFormatter
                                                          <extendable>...
          rule = "less_than:180" [required] - see more...
          formatString = "" [required] - see more...
        
        [Fileters]
        
        [Filter name="{string}" enabled="{true/false}" ruleType="{string:ruleType*}" rule="{string:rule*}" extractFrom="_Path_"]
          name = "filter_name" [optional] - not used actually, just a name.
          enabled = "true" [optional default="true"]
          ruleType = "RegularExpressionFilter" [required] - *ArithmeticRuleProcessor
                                                            *AutoGenIntRuleProcessor
                                                            *ConditionalRuleProcessor
                                                            *DriverLabelRuleProcessor
                                                            *FilesTypeRuleProcessor
                                                            *RegularExpressionRuleProcessor
                                                            *SimpleReplacementRuleProcess
          rule = "======" [required] - The rule depends the rule type you selected.
          extractFrom = "_Path_" [required] - From every column defined, including the internal defined with "_..._", allow string.Empty
        
        [Locations]
        
        [Location name="{string}" enabled="{true/false}" path="{string:path*}" include="{string:include*}"]
          name = "location_name" [optional] - not used actually, just a name.
          enabled = "true" [optional default="true"]
          path = "\\mainframe1601\640G_02\HD.Movies" [required] - *NetworkVolume e.g. \\mainframe1601\640G_02\HD.Movies
                                                                  *IPLocation e.g. \\192.168.2.165\高清电影02
                                                                  *LocalDrive e.g. C:\New Folder
                                                                  *LocalDriveVolume e.g. 2048G_01\07.Movies
          include = "Folder" [optional default="Folder"] - *Folder
                                                           *Ant file search pattern e.g. *.mp3
        [Columns]
        
        [Column name="{string}" primary="{true/false}" timestamp="{true/false}" output="{true/false}" hyperlink="{true/false}" enabled="{true/false}" ruleType="{string:ruleType*}" rule="{string:rule*}" extractFrom="_AutoIncrease_"]
          name = "序号" [required] - !very important, it is the name finally get into the excel.
          enabled = "true" [optional default="true"]
          primary = "true" [optional default="false"]
          timestamp = "true" [optional default="false"]
          output = "true" [optional default="true"]
          hyperlink = "false" [optional default="false"]
          ruleType = "RegularExpressionFilter" [required] - *ArithmeticRuleProcessor
                                                            *AutoGenIntRuleProcessor
                                                            *ConditionalRuleProcessor
                                                            *DriverLabelRuleProcessor
                                                            *FilesTypeRuleProcessor
                                                            *RegularExpressionRuleProcessor
                                                            *SimpleReplacementRuleProcess
          rule = "======" [required] - The rule depends the rule type you selected.
          extractFrom = "_Path_" [required] - From every column defined, including the internal defined with "_..._", allow string.Empty
-->
<Document templatePath="c:\template.xlsx" baselinePath="c:\mjm.xlsx" backup="true" outputPath="c:\mjm.xlsx">
    <Sheets>
        <Sheet name="高清电影" enabled="true" mode="append" maxRowCount="600" refMode="false">
            <Formatters>
                <Formatter enabled="true" name="append_formatter" extractFrom="" ruleType="AppendedItemFormatter" rule="" formatString="fore-color:darkgreen;font-bold;font-italic"></Formatter>
                <Formatter enabled="false" name="update_formatter" extractFrom="" ruleType="UpdatedItemFormatter" rule="" formatString="back-color:darkblue;fore-color:yellow"></Formatter>
                <Formatter enabled="false" name="refresh_formatter" extractFrom="" ruleType="RefreshedItemFormatter" rule="" formatString="fore-color:red"></Formatter>
                <Formatter enabled="false" name="duplicated_formatter" extractFrom="中文名" ruleType="DuplicatedItemFormatter" rule="" formatString="back-color:green;fore-color:pink"></Formatter>
                <Formatter enabled="false" name="deleted_formatter" extractFrom="" ruleType="DeletedItemFormatter" rule="_static.deleted_" formatString="font-strikethrough;back-color:black;fore-color:white"></Formatter>
                <Formatter enabled="false" name="formatter1" extractFrom="大小(MB)" ruleType="NumberCompareFormatter" rule="less_than:180" formatString="fore-color:green;back-color:red"></Formatter>
            </Formatters>
            <Filters>
                <Filter name="1" extractFrom="_Path_" ruleType="RegularExpressionFilter" rule="======"></Filter>
            </Filters>
            <Locations>
                <Location enabled="false" path="\\mainframe1601\640G_02\HD.Movies" include="Folder"></Location>
                <Location enabled="false" path="\\192.168.2.165\高清电影02" include="*.mp3"></Location>
                <Location enabled="false" path="\\192.168.2.165\高清电影04"></Location>
                <Location name="Test1" enabled="true" path="C:\New Folder" include="folder"></Location>
                <Location name="Test2" enabled="false" path="C:\New Folder2" include="folder"></Location>
            </Locations>
            <Columns>
                <Column name="序号"   extractFrom="_AutoIncrease_" ruleType="" rule="" ></Column>

              <Column name="全部"   extractFrom="_Path_"     ruleType="RegularExpressionRuleProcessor"     primary="true"  rule="pattern:=(?&lt;=\\)[^\\]*(?=$)" ></Column>
              <Column name="地址"   hyperlink="true" extractFrom="_Path_"     ruleType="DefaultRuleProcessor" rule="" ></Column>
              <Column name="中文名" extractFrom="全部"     ruleType="RegularExpressionRuleProcessor" rule="pattern:=(?&lt;=^|\])[\u4e00-\u9fa5\w][^\[\]\\]*?(?=[\.\[]|$)" ></Column>
                <Column name="英文名" extractFrom="全部"     ruleType="RegularExpressionRuleProcessor" rule="pattern:=(?&lt;=\.)[^\u4e00-\u9fa5]*?(?=\.[12][980]\d{2})" ></Column>
                <Column name="文件类型" extractFrom="_FilesType_" ruleType="FilesTypeRuleProcessor" rule="exclude:=.jpg,.txt,.png,.nfo;include:=" ></Column>
                <Column name="位置"   extractFrom="_Path_"     ruleType="DriverLabelRuleProcessor" rule="" ></Column>
                <Column name="目录1" output="false"  extractFrom="全部"     ruleType="RegularExpressionRuleProcessor" rule="pattern:=\[(.*?)\]" ></Column>
                <Column name="目录2"   extractFrom="目录1"     ruleType="SimpleReplacementRuleProcess" rule="exp:=欧美->1,电影->2;" ></Column>
                <Column name="目录"   extractFrom="中文名"     ruleType="ConditionalRuleProcessor" rule="statement:=&quot;{source}&quot;.Contains(&quot;电脑游戏&quot;)?&quot;电脑游戏&quot;:&quot;&quot;{end},&quot;{source}&quot;.Contains(&quot;主机游戏&quot;)?&quot;主机游戏&quot;:&quot;&quot;{end}"></Column>
                    <!--rule="statement:=&quot;{source}&quot;.StartsWith(&quot;12&quot;)?33:44"-->
                <Column name="来源"   extractFrom="全部"     ruleType="RegularExpressionRuleProcessor" rule="pattern:=\.[12][980]\d{2}\.?.*[-@](.*)" ></Column>
                <Column name="年份"   extractFrom="全部" ruleType="RegularExpressionRuleProcessor" rule="pattern:=(?&lt;=\.)[12][980]\d{2}" ></Column>
                <Column name="编码"   extractFrom="全部" ruleType="RegularExpressionRuleProcessor" rule="pattern:=(?&lt;=\.[12][980]\d{2}\.?).*(?=[-@])" ></Column>
                <Column name="大小(MB)"   extractFrom="_Size_"     ruleType="ArithmeticRuleProcessor" rule="exp:={source}/1024/1024;format:=###0" ></Column>
                <Column name="DVD碟数"   extractFrom="_Size_"     ruleType="ArithmeticRuleProcessor" rule="exp:={source}/4456028569.6;format:=###0.#"></Column>
                <Column name="最后更新时间" extractFrom="_LastModified_" ruleType="" timestamp="true" rule="" ></Column>
            </Columns>
        </Sheet>
        <Sheet name="普清电影" enabled="false" mode="refresh" maxRowCount="600">
            <Formatters>
                <Formatter name="append_formatter" extractFrom="" ruleType="AppendedItemFormatter" rule="" formatString="back-color:red;font-bold;font-italic"></Formatter>
                <Formatter name="update_formatter" extractFrom="" ruleType="UpdatedItemFormatter" rule="" formatString="back-color:darkblue;fore-color:yellow"></Formatter>
                <Formatter enabled="false" name="refresh_formatter" extractFrom="" ruleType="RefreshedItemFormatter" rule="" formatString="fore-color:red"></Formatter>
                <Formatter name="duplicated_formatter" extractFrom="中文名" ruleType="DuplicatedItemFormatter" rule="" formatString="back-color:green;fore-color:pink"></Formatter>
                <Formatter name="formatter1" extractFrom="大小(MB)" ruleType="NumberCompareFormatter" rule="less_than:180" formatString="fore-color:yellow;back-color:red"></Formatter>
            </Formatters>
            <Filters>
                <Filter name="1" extractFrom="_Path_" ruleType="RegularExpressionFilter" rule="---------"></Filter>
            </Filters>
            <Locations>
                <Location path="\\192.168.1.105\普清电影"></Location>
            </Locations>
            <Columns>
                <Column name="序号"   extractFrom="_AutoIncrease_" ruleType="" rule="" ></Column>
                <Column name="全部"   extractFrom="_Path_"     ruleType="RegularExpressionRuleProcessor" primary="true" rule="(?&lt;=\\)[^\\]*(?=$)" ></Column>
                <Column name="中文名" extractFrom="全部"     ruleType="RegularExpressionRuleProcessor" rule="(?&lt;=^|\])[\u4e00-\u9fa5\w][^\[\]\\]*?(?=[\.\[]|$)" ></Column>
                <Column name="英文名" extractFrom="全部"     ruleType="RegularExpressionRuleProcessor" rule="(?&lt;=\.)[^\u4e00-\u9fa5]*?(?=\.[12][980]\d{2})" ></Column>
                <Column name="文件类型" extractFrom="_FilesType_" ruleType="FilesTypeRuleProcessor" rule="exclude:.jpg,.txt,.png,.nfo" ></Column>
                <Column name="位置"   extractFrom="_Path_"     ruleType="DriverLabelRuleProcessor" rule="" ></Column>
                <Column name="目录"   extractFrom="全部"     ruleType="RegularExpressionRuleProcessor" rule="\[(.*?)\]" ></Column>
                <Column name="大小(MB)"   extractFrom="_Size_"     ruleType="ArithmeticRuleProcessor" rule="divide > 1048576 > ###0 >" ></Column>
                <Column name="最后更新时间" extractFrom="_LastModified_" ruleType="" timestamp="true" rule="" ></Column>
            </Columns>
        </Sheet>
      <Sheet name="游戏" enabled="false" mode="append" maxRowCount="800" refMode="true">
        <Filters>
          <Filter name="1" extractFrom="_Path_" ruleType="RegularExpressionFilter" rule="-+-$"></Filter>
        </Filters>
        <Formatters>
          <Formatter enabled="false" name="append_formatter" extractFrom="" ruleType="AppendedItemFormatter" rule="" formatString="back-color:red;font-bold;font-italic"></Formatter>
          <Formatter enabled="false" name="update_formatter" extractFrom="" ruleType="UpdatedItemFormatter" rule="" formatString="back-color:darkblue;fore-color:yellow"></Formatter>
          <Formatter enabled="false" name="refresh_formatter" extractFrom="" ruleType="RefreshedItemFormatter" rule="" formatString="fore-color:red"></Formatter>
          <Formatter name="duplicated_formatter" extractFrom="中文名" ruleType="DuplicatedItemFormatter" rule="" formatString="back-color:green;fore-color:pink"></Formatter>
          <Formatter enabled="false" name="formatter1" extractFrom="大小" ruleType="NumberCompareFormatter" rule="less_than:180" formatString="fore-color:yellow;back-color:red"></Formatter>
          <Formatter enabled="false" name="formatter2" extractFrom="最后更新时间" ruleType="DateTimeCompareFormatter" rule="greater_than:2010/09/24" formatString="fore-color:green;back-color:yellow"></Formatter>
        </Formatters>
        <Locations>
          <Location enabled="true" path="\\rabook\808G_01\03.Games\电脑游戏"></Location>
          <Location enabled="true" path="\\rabook\2048G_01\03.Games"></Location>
          <Location enabled="true" path="\\rabook\2048G_02\03.Games\___电脑游戏"></Location>
          <Location enabled="false" path="C:\03.Games"></Location>
          <Location enabled="false" path="C:\03.Games2"></Location>
          <Location enabled="false" path="C:\03.Games3"></Location>
        </Locations>
        <Columns>
          <Column name="序号" extractFrom="_AutoIncrease_" ruleType="" rule=""></Column>
          <Column name="全部"   extractFrom="_Path_"     ruleType="RegularExpressionRuleProcessor"     primary="true"  rule="pattern:=(?&lt;=\\)[^\\]*(?=$)" ></Column>
          <Column name="中文名" extractFrom="全部"     ruleType="RegularExpressionRuleProcessor" rule="pattern:=(?&lt;=^|\])[\u4e00-\u9fa5\w][^\[\]\\]*?(?=[\.\[]|$)" ></Column>
          <Column name="英文名" extractFrom="全部"     ruleType="RegularExpressionRuleProcessor" rule="pattern:=(?&lt;=\.)[^\u4e00-\u9fa5]*?(?=\.[12][980]\d{2})" ></Column>
          <Column name="文件类型" extractFrom="_FilesType_" ruleType="FilesTypeRuleProcessor" rule="exclude:=.jpg,.txt,.png,.nfo" ></Column>
          <Column name="位置"   extractFrom="_Path_"     ruleType="DriverLabelRuleProcessor" rule="" ></Column>
          <Column name="游戏分类" extractFrom="_Path_" ruleType="ConditionalRuleProcessor" rule="statement:=&quot;{source}&quot;.Contains(&quot;电脑游戏&quot;)?&quot;电脑游戏&quot;:&quot;&quot;,&quot;{source}&quot;.Contains(&quot;主机游戏&quot;)?&quot;主机游戏&quot;:&quot;&quot;"></Column>
          <Column name="出品年代" extractFrom="_FromFile_" ruleType="RegularExpressionRuleProcessor" rule="pattern:=出品年代：([\w\W]*?)[\r\n]"></Column>
          <Column name="游戏类型" extractFrom="_FromFile_" ruleType="RegularExpressionRuleProcessor" rule="pattern:=游戏类型：([\w\W]*?)[\r\n]"></Column>
          <Column name="语言" extractFrom="_FromFile_" ruleType="RegularExpressionRuleProcessor" rule="pattern:=语\s*?言：([\w\W]*?)[\r\n]"></Column>
          <Column name="游戏版本" extractFrom="_FromFile_" ruleType="RegularExpressionRuleProcessor" rule="pattern:=游戏版本：([\w\W]*?)[\r\n]"></Column>
          <Column name="破解组织" extractFrom="_FromFile_" ruleType="RegularExpressionRuleProcessor" rule="pattern:=破解组织：([\w\W]*?)[\r\n]"></Column>
          <Column name="制作公司" extractFrom="_FromFile_" ruleType="RegularExpressionRuleProcessor" rule="pattern:=制作公司：([\w\W]*?)[\r\n]"></Column>
          <Column name="发行公司" extractFrom="_FromFile_" ruleType="RegularExpressionRuleProcessor" rule="pattern:=发行公司：([\w\W]*?)[\r\n]"></Column>
          <Column name="附加信息" extractFrom="_FromFile_" ruleType="RegularExpressionRuleProcessor" rule="pattern:=附加信息：([\w\W]*?)[\r\n]"></Column>
          <Column name="游戏必读" extractFrom="_FromFile_" ruleType="RegularExpressionRuleProcessor" rule="pattern:=游戏必读：([\w\W]*?)[\r\n]"></Column>
          <Column name="详细描述" extractFrom="_FromFile_" ruleType="RegularExpressionRuleProcessor" rule="pattern:=详细描述：([\w\W]*?)->ed"></Column>
          <Column name="大小(MB)" extractFrom="_Size_" ruleType="ArithmeticRuleProcessor" rule="exp:={source}/(1024*1024);format:=###0"></Column>
          <Column name="最后更新时间" extractFrom="_LastModified_" ruleType="" timestamp="true" rule="" ></Column>
        </Columns>
      </Sheet>
        <Sheet name="动画" enabled="false" mode="refresh" maxRowCount="300">
            <Formatters>
                <Formatter name="append_formatter" extractFrom="" ruleType="AppendedItemFormatter" rule="" formatString="back-color:red;font-bold;font-italic"></Formatter>
                <Formatter name="update_formatter" extractFrom="" ruleType="UpdatedItemFormatter" rule="" formatString="back-color:darkblue;fore-color:yellow"></Formatter>
                <Formatter enabled="false" name="refresh_formatter" extractFrom="" ruleType="RefreshedItemFormatter" rule="" formatString="fore-color:red"></Formatter>
                <Formatter name="duplicated_formatter" extractFrom="中文名" ruleType="DuplicatedItemFormatter" rule="" formatString="back-color:green;fore-color:pink"></Formatter>
                <Formatter name="formatter1" extractFrom="大小(MB)" ruleType="NumberCompareFormatter" rule="less_than:180" formatString="fore-color:yellow;back-color:red"></Formatter>
            </Formatters>
            <Filters>
                <Filter name="1" extractFrom="_Path_" ruleType="RegularExpressionFilter" rule="---------"></Filter>
            </Filters>
            <Locations>
                <Location path="G:\06.Cartoons"></Location>
            </Locations>
            <Columns>
                <Column name="序号"   extractFrom="_AutoIncrease_" ruleType="" rule="" ></Column>
                <Column name="全部"   extractFrom="_Path_"     ruleType="RegularExpressionRuleProcessor" primary="true" rule="(?&lt;=\\)[^\\]*(?=$)" ></Column>
                <Column name="中文名" extractFrom="全部"     ruleType="RegularExpressionRuleProcessor" rule="(?&lt;=^|\])[\u4e00-\u9fa5\w][^\[\]\\]*?(?=[\.\[]|$)" ></Column>
                <Column name="英文名" extractFrom="全部"     ruleType="RegularExpressionRuleProcessor" rule="(?&lt;=\.)[^\u4e00-\u9fa5]*?(?=\.[12][980]\d{2})" ></Column>
                <Column name="文件类型" extractFrom="_FilesType_" ruleType="FilesTypeRuleProcessor" rule="exclude:.jpg,.txt,.png,.nfo" ></Column>
                <Column name="位置"   extractFrom="_Path_"     ruleType="DriverLabelRuleProcessor" rule="" ></Column>
                <Column name="目录"   extractFrom="全部"     ruleType="RegularExpressionRuleProcessor" rule="\[(.*?)\]" ></Column>
                <Column name="大小(MB)"   extractFrom="_Size_"     ruleType="ArithmeticRuleProcessor" rule="divide > 1048576 > ###0 >" ></Column>
                <Column name="最后更新时间" extractFrom="_LastModified_" ruleType="" timestamp="true" rule="" ></Column>
            </Columns>
        </Sheet>
    </Sheets>
</Document>